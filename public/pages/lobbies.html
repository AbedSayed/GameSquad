<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lobbies - GameSquad</title>
    
    <!-- Unified Theme System -->
    <link rel="stylesheet" href="../css/gamesquad-theme.css">
    <link rel="stylesheet" href="../css/animations.css">
    <link rel="stylesheet" href="../css/gaming-styles.css">
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/lobby.css">
    
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
    <!-- Google fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@400;500;600;700&family=Exo+2:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <header>
        <nav class="navbar">
            <div class="logo">
                <h1 class="sheen"><a href="../index.html">GameSquad</a></h1>
            </div>
            <ul class="nav-links">
                <li><a href="../home.html">Home</a></li>
                <li><a href="lobbies.html" class="active">Lobbies</a></li>
                <li><a href="create-lobby.html">Create Lobby</a></li>
                <li><a href="players.html">Players</a></li>
                <li><a href="about.html">About</a></li>
            </ul>
            <div class="user-profile">
                <span class="username">Username <i class="fas fa-chevron-down"></i></span>
                <div class="profile-dropdown">
                    <a href="profile.html"><i class="fas fa-user"></i> My Profile</a>
                    <a href="messages.html"><i class="fas fa-envelope"></i> Messages</a>
                    <a href="#" class="logout-btn"><i class="fas fa-sign-out-alt"></i> Logout</a>
                </div>
            </div>
            <div class="hamburger">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
            </div>
        </nav>
    </header>

    <main class="container">
        <div class="page-header hexagon-bg">
            <h1 class="neon-text">Game Lobbies</h1>
            <p>Join existing lobbies or create your own to find the perfect teammates</p>
        </div>

        <div class="server-status">
            <div class="status-indicator online"></div>
            <span class="server-name">Matchmaking Servers:</span>
            <span class="server-info">All systems operational</span>
        </div>

        <div class="filter-tabs">
            <button class="tab-btn active" data-tab="all">All Lobbies</button>
            <button class="tab-btn" data-tab="fps">FPS</button>
            <button class="tab-btn" data-tab="moba">MOBA</button>
            <button class="tab-btn" data-tab="battle-royale">Battle Royale</button>
            <button class="tab-btn" data-tab="rpg">RPG</button>
        </div>

        <div class="filters-section rotating-border" style="background-color: rgba(18, 18, 24, 0.85) !important; border: 1px solid rgba(87, 70, 175, 0.3) !important;">
            <div class="filters-title">
                <h2>Filters</h2>
                <button class="toggle-filters-btn btn btn-secondary btn-hover-fx">
                    <i class="fas fa-filter"></i> <span>Toggle Filters</span>
                </button>
            </div>
            <div class="filters-form">
                <div class="filter-group">
                    <label for="gameFilter">Game</label>
                    <select id="gameFilter" class="filter-input" style="background-color: rgba(30, 30, 40, 0.7) !important; color: #fff !important; border: 1px solid rgba(87, 70, 175, 0.3) !important;">
                        <option value="">Any game</option>
                        <option value="valorant">Valorant</option>
                        <option value="csgo">Counter-Strike 2</option>
                        <option value="lol">League of Legends</option>
                        <option value="apex">Apex Legends</option>
                        <option value="fortnite">Fortnite</option>
                        <option value="dota2">Dota 2</option>
                        <option value="overwatch">Overwatch 2</option>
                        <option value="rocketleague">Rocket League</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="regionFilter">Region</label>
                    <select id="regionFilter" class="filter-input" style="background-color: rgba(30, 30, 40, 0.7) !important; color: #fff !important; border: 1px solid rgba(87, 70, 175, 0.3) !important;">
                        <option value="">Any region</option>
                        <option value="na">North America</option>
                        <option value="eu">Europe</option>
                        <option value="asia">Asia</option>
                        <option value="sa">South America</option>
                        <option value="oceania">Oceania</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="rankFilter">Skill Level</label>
                    <select id="rankFilter" class="filter-input" style="background-color: rgba(30, 30, 40, 0.7) !important; color: #fff !important; border: 1px solid rgba(87, 70, 175, 0.3) !important;">
                        <option value="">Any rank</option>
                        <option value="iron">Iron</option>
                        <option value="bronze">Bronze</option>
                        <option value="silver">Silver</option>
                        <option value="gold">Gold</option>
                        <option value="platinum">Platinum</option>
                        <option value="diamond">Diamond</option>
                        <option value="master">Master</option>
                        <option value="grandmaster">Grandmaster</option>
                        <option value="challenger">Challenger</option>
                        <option value="immortal">Immortal</option>
                        <option value="radiant">Radiant</option>
                        <option value="beginner">Beginner</option>
                        <option value="intermediate">Intermediate</option>
                        <option value="advanced">Advanced</option>
                        <option value="expert">Expert</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="statusFilter">Status</label>
                    <select id="statusFilter" class="filter-input" style="background-color: rgba(30, 30, 40, 0.7) !important; color: #fff !important; border: 1px solid rgba(87, 70, 175, 0.3) !important;">
                        <option value="">Any status</option>
                        <option value="waiting">Waiting</option>
                        <option value="in_progress">In Progress</option>
                        <option value="full">Full</option>
                    </select>
                </div>
                <div class="filter-actions">
                    <button class="btn reset-filters btn-secondary btn-hover-fx">
                        <i class="fas fa-undo"></i> <span>Reset</span>
                    </button>
                    <button class="btn apply-filters btn-primary btn-hover-fx">
                        <i class="fas fa-check"></i> <span>Apply</span>
                    </button>
                </div>
            </div>
        </div>

        <div class="lobbies-grid">
            <div class="my-lobbies-section">
                <h2 class="section-title neon-text">YOUR LOBBIES</h2>
                <div class="lobbies-grid-section fade-stagger" id="myLobbies">
                    <!-- My lobbies will be added here dynamically by the JavaScript -->
                    <div class="loading">
                        <i class="fas fa-spinner fa-spin"></i>
                        <p>Loading your lobbies...</p>
                    </div>
                </div>
            </div>
            
            <div class="other-lobbies-section">
                <h2 class="section-title neon-text-secondary">AVAILABLE LOBBIES</h2>
                <div class="lobbies-grid-section fade-stagger" id="otherLobbies">
                    <!-- Other lobbies will be added here dynamically by the JavaScript -->
                    <div class="loading">
                        <i class="fas fa-spinner fa-spin"></i>
                        <p>Loading available lobbies...</p>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="create-lobby-cta rotating-border">
            <h2 class="neon-text">Want to create your own lobby?</h2>
            <p>Customize your gaming experience by setting up a lobby with your preferred game, skill level, and more.</p>
            <a href="create-lobby.html" class="btn btn-primary btn-hover-fx">
                <i class="fas fa-plus"></i> <span>Create New Lobby</span>
            </a>
        </div>
    </main>

    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-logo">
                    <h2 class="neon-text">GameSquad</h2>
                    <p>Find your perfect gaming team</p>
                </div>
                <div class="footer-links">
                    <div class="footer-column">
                        <h3>Navigation</h3>
                        <ul>
                            <li><a href="../index.html">Home</a></li>
                            <li><a href="lobbies.html">Lobbies</a></li>
                            <li><a href="players.html">Players</a></li>
                            <li><a href="about.html">About</a></li>
                        </ul>
                    </div>
                    <div class="footer-column">
                        <h3>Legal</h3>
                        <ul>
                            <li><a href="terms.html">Terms of Service</a></li>
                            <li><a href="privacy.html">Privacy Policy</a></li>
                            <li><a href="cookies.html">Cookie Policy</a></li>
                        </ul>
                    </div>
                    <div class="footer-column">
                        <h3>Support</h3>
                        <ul>
                            <li><a href="faq.html">FAQ</a></li>
                            <li><a href="contact.html">Contact Us</a></li>
                            <li><a href="report-bug.html">Report a Bug</a></li>
                        </ul>
                    </div>
                </div>
                <div class="footer-social">
                    <h3>Follow Us</h3>
                    <div class="social-icons">
                        <a href="#" class="power-button"><i class="fab fa-discord"></i></a>
                        <a href="#" class="power-button"><i class="fab fa-twitter"></i></a>
                        <a href="#" class="power-button"><i class="fab fa-instagram"></i></a>
                        <a href="#" class="power-button"><i class="fab fa-youtube"></i></a>
                    </div>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 GameSquad. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <div class="notifications-container"></div>

    <!-- Scripts -->
    <script src="../js/gamesquad-ui.js"></script>
    <script src="../js/config.js"></script>
    <script src="../js/auth.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // TEMPORARY FIX: Force reset of lobbies to fix filtering issues
            localStorage.setItem('reset_lobbies', 'true');
            
            // Apply particle effect to header
            applyParticleEffect('.page-header');
            
            // Toggle filters
            const toggleFiltersBtn = document.querySelector('.toggle-filters-btn');
            const filtersForm = document.querySelector('.filters-form');
            
            if (toggleFiltersBtn && filtersForm) {
                toggleFiltersBtn.addEventListener('click', function() {
                    filtersForm.classList.toggle('visible');
                });
            }
            
            // Tab switching
            const tabButtons = document.querySelectorAll('.tab-btn');
            const gameCards = document.querySelectorAll('.game-card');
            
            tabButtons.forEach(btn => {
                btn.addEventListener('click', function() {
                    // Remove active class from all tabs
                    tabButtons.forEach(b => b.classList.remove('active'));
                    
                    // Add active to clicked tab
                    this.classList.add('active');
                    
                    const tabType = this.getAttribute('data-tab');
                    
                    // Filter cards
                    if (tabType === 'all') {
                        gameCards.forEach(card => {
                            card.style.display = 'block';
                        });
                    } else {
                        gameCards.forEach(card => {
                            const badges = card.querySelectorAll('.game-badge');
                            let hasMatch = false;
                            
                            badges.forEach(badge => {
                                if (badge.classList.contains(tabType)) {
                                    hasMatch = true;
                                }
                            });
                            
                            card.style.display = hasMatch ? 'block' : 'none';
                        });
                    }
                });
            });
            
            // Form filters (connect with lobbies.js)
            const gameFilter = document.getElementById('gameFilter');
            const regionFilter = document.getElementById('regionFilter');
            const rankFilter = document.getElementById('rankFilter');
            const statusFilter = document.getElementById('statusFilter');
            const resetFilterBtn = document.querySelector('.reset-filters');
            const applyFilterBtn = document.querySelector('.apply-filters');
            
            // Apply filters when the button is clicked
            if (applyFilterBtn) {
                applyFilterBtn.addEventListener('click', function() {
                    const gameValue = gameFilter ? gameFilter.value : '';
                    
                    const filters = {
                        game: gameValue,
                        rank: rankFilter ? rankFilter.value : '',
                        region: regionFilter ? regionFilter.value : '',
                        status: statusFilter ? statusFilter.value : ''
                    };
                    
                    // Load lobbies with the selected filters
                    window.Lobby.loadLobbies(filters);
                    
                    // Show notification
                    showNotification('Filters applied successfully', 'success');
                });
            }
            
            // Reset filters
            if (resetFilterBtn) {
                resetFilterBtn.addEventListener('click', function() {
                    if (gameFilter) gameFilter.value = '';
                    if (rankFilter) rankFilter.value = '';
                    if (regionFilter) regionFilter.value = '';
                    if (statusFilter) statusFilter.value = '';
                    
                    // Load all lobbies
                    window.Lobby.loadLobbies();
                    
                    // Show notification
                    showNotification('Filters have been reset', 'info');
                });
            }
        });
        
        // Helper function to show notifications
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <i class="fas fa-${type === 'error' ? 'exclamation-circle' : 
                                   type === 'success' ? 'check-circle' : 'info-circle'}"></i>
                <span>${message}</span>
            `;

            const container = document.querySelector('.notifications-container');
            container.appendChild(notification);

            // Remove notification after 5 seconds
            setTimeout(() => {
                notification.classList.add('fade-out');
                setTimeout(() => notification.remove(), 300);
            }, 5000);
        }
    </script>
    <!-- Make sure lobbies.js is loaded after all other scripts -->
    <script src="../js/lobbies.js"></script>
</body>
</html>
